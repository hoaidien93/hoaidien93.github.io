define(["API/Post"],()=>({viewModel:function(){const postAPI=require("API/Post");let request=this._request;this.countImage=ko.observable(""),this.isShowImageView=ko.observable(!1),this.listComment=ko.observableArray([]);let fullComment=[];this.myComment=ko.observable(""),this.showMore=ko.computed(()=>this.listComment().length<fullComment.length),this.pagingImage=ko.observable({current:0,max:7}),this.postDetail=ko.observable({title:"",location:"",phone:"",description:"",area:"",dateCreate:"",price:0,images:[],avatar_user_post:"",use_post:""}),postAPI.getPostDetail(request.id).then(res=>{let data=res.data;console.log(data),data.dateCreate=new Date(data.created_at).toLocaleDateString();let length=data.images.length;length>5&&this.countImage("+"+(length-5)),this.pagingImage().max=length,this.pagingImage(this.pagingImage()),this.postDetail(data),fullComment=data.comment_infos,this.listComment(data.comment_infos.filter((e,index)=>index<=2))}).catch(e=>{console.log(res)}),this.showMoreAction=(()=>{let len=this.listComment().length;this.listComment.push(...fullComment.filter((e,index)=>index>=len&&index<len+5))}),this.showImage=(index=>{this.isShowImageView(!0),updateIndexImage(++index)});let updateIndexImage=index=>{let desIndex=index;index<=1&&(desIndex=1),index>=this.pagingImage().max&&(desIndex=this.pagingImage().max),this.pagingImage().current=desIndex,this.pagingImage(this.pagingImage())};this.closeImageView=(()=>{this.isShowImageView(!1)}),this.changeIndexImage=((data,event)=>{let currentIndex=this.pagingImage().current;switch(event.detail.direction){case"left":updateIndexImage(++currentIndex);break;case"right":updateIndexImage(--currentIndex)}}),this.addComment=(()=>{postAPI.addComment(request.id,this.myComment()).then(res=>{0==res.code&&(this.listComment.unshift({avatar_uer_comment:"https://huongnq.s3-ap-southeast-1.amazonaws.com/avatars/defaut.jpg",user_comment:"hoaidien",content:this.myComment(),created_at:Date.now()}),this.myComment(""))}).catch(e=>{console.log(e)})})},template:'\n            <div id="post-detail-page" data-bind="using: postDetail">\n    <com-slider></com-slider>\n    <com-headercontext></com-headercontext>\n    <div\n        data-bind="class: $root.isShowImageView() ? \'image-viewer active\': \'image-viewer\', event: {swipe : $root.changeIndexImage}">\n        <div class="close-image" data-bind="event: {tap: $root.closeImageView}">X</div>\n        <img data-bind="attr: {src: images[$root.pagingImage().current - 1]}">\n        <div class="count" data-bind="using: $root.pagingImage">\n            <span data-bind="text: current"></span>\n            /\n            <span data-bind="text: max"></span>\n        </div>\n    </div>\n    <div class="body-content">\n        <div class="list-image">\n            <div class="img-top">\n                <div\n                    data-bind="style: {\'background-image\': \'url(\' + (images[0] || \'./img/example.jpg\')+\')\'},event: {tap:$root.showImage.bind(this, 0)}">\n                </div>\n                <div\n                    data-bind="style: {\'background-image\': \'url(\' + (images[1] || \'./img/example.jpg\')+\')\'},event: {tap:$root.showImage.bind(this, 1)}">\n                </div>\n            </div>\n            <div class="bottom">\n                <div\n                    data-bind="style: {\'background-image\': \'url(\' + (images[2] || \'./img/example.jpg\')+\')\'},event: {tap:$root.showImage.bind(this, 2)}">\n                </div>\n                <div\n                    data-bind="style: {\'background-image\': \'url(\' + (images[3] || \'./img/example.jpg\')+\')\'},event: {tap:$root.showImage.bind(this, 3)}">\n                </div>\n                <div\n                    data-bind="style: {\'background-image\': \'url(\' + (images[4] || \'./img/example.jpg\')+\')\'},event: {tap:$root.showImage.bind(this,4)}">\n                </div>\n            </div>\n        </div>\n        <div class="content-wrapper">\n            <div class="title">\n                <svg xmlns="http://www.w3.org/2000/svg" width="17.375" height="20" viewBox="0 0 17.375 20">\n                    <path id="Path_1151" data-name="Path 1151"\n                        d="M-456.37-97.116c.141.065.284.126.423.194a8.026,8.026,0,0,1,2.253,1.7,11.46,11.46,0,0,1,2.426,4.025c.162.443.289.9.432,1.348l.027.085a2,2,0,0,0,.541-.812,3.431,3.431,0,0,0,.176-1.507,4.817,4.817,0,0,0-.284-1.257c.027.02.055.039.081.06a10.418,10.418,0,0,1,1.4,1.507,13.78,13.78,0,0,1,2.113,3.694,8.832,8.832,0,0,1,.6,3.555,7.206,7.206,0,0,1-1.188,3.618,10.476,10.476,0,0,1-2.55,2.648,16.307,16.307,0,0,1-1.663,1.09c-.026.015-.052.028-.1.051.018-.042.028-.069.04-.095a7.988,7.988,0,0,0,.8-2.818,9.817,9.817,0,0,0-2.421-7.54,7.641,7.641,0,0,0-1.32-1.2c-.033-.024-.066-.046-.085-.059a7.57,7.57,0,0,1-1.622,5.506,4.09,4.09,0,0,0-.55-2.915c-.049.19-.088.358-.136.522A9.8,9.8,0,0,1-458.3-82.9a6.572,6.572,0,0,0-.888,1.725,4.515,4.515,0,0,0,.011,2.7c.123.412.3.809.449,1.212.015.041.035.079.063.141-.042-.02-.064-.03-.086-.042a15.934,15.934,0,0,1-2.458-1.676,6.926,6.926,0,0,1-1.856-2.289,5.134,5.134,0,0,1-.479-2.376,7.871,7.871,0,0,1,.794-3.181c.334-.706.685-1.4,1.019-2.111a7.619,7.619,0,0,0,.629-1.847c.036-.2.06-.394.091-.6a6.693,6.693,0,0,1,.8,3.28.6.6,0,0,0,.056-.05,22.6,22.6,0,0,0,2.654-3.972,11.161,11.161,0,0,0,1-2.719,6.646,6.646,0,0,0,.118-2.311c0-.033,0-.068,0-.1Z"\n                        transform="translate(463.546 97.116)" fill="#f0cc40" />\n                </svg>\n                <span data-bind="text: title"></span>\n            </div>\n            <div class="price">\n                Giá: <span data-bind="convertMoney: price"></span><span> / tháng</span>\n            </div>\n            <div class="status">\n                <div>\n                    <div>Còn Phòng</div>\n                    <div>Còn</div>\n                </div>\n                <div>\n                    <div>Diện tích</div>\n                    <div><span data-bind="text: area"></span>&nbsp;m²</div>\n                </div>\n                <div>\n                    <div>Đặt cọc</div>\n                    <div>1 tháng</div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="other-content">\n        <div class="title">\n            Địa chỉ\n        </div>\n        <div class="street">\n            <svg xmlns="http://www.w3.org/2000/svg" width="10.114" height="15" viewBox="0 0 10.114 15">\n                <g id="Group_1458" data-name="Group 1458" transform="translate(2858.576 -1585.992)">\n                    <path id="Path_1725" data-name="Path 1725"\n                        d="M-2819.8,1627.21a2.45,2.45,0,0,1-2.447-2.447,2.45,2.45,0,0,1,2.447-2.447,2.45,2.45,0,0,1,2.447,2.447A2.45,2.45,0,0,1-2819.8,1627.21Zm0-3.816a1.371,1.371,0,0,0-1.369,1.369,1.371,1.371,0,0,0,1.369,1.369,1.371,1.371,0,0,0,1.369-1.369A1.37,1.37,0,0,0-2819.8,1623.394Z"\n                        transform="translate(-33.715 -33.714)" fill="#f79900" />\n                    <path id="Path_1726" data-name="Path 1726"\n                        d="M-2853.519,1600.992a.752.752,0,0,1-.667-.4l-3.63-6.877-.006-.013a8.21,8.21,0,0,1-.754-2.651,5.063,5.063,0,0,1,5.057-5.057,5.063,5.063,0,0,1,5.057,5.057,8.216,8.216,0,0,1-.754,2.651l-.013.026-3.623,6.864A.751.751,0,0,1-2853.519,1600.992Zm-3.329-7.756,3.329,6.307,3.329-6.307a7.238,7.238,0,0,0,.65-2.187,3.984,3.984,0,0,0-3.979-3.979,3.984,3.984,0,0,0-3.979,3.979A7.241,7.241,0,0,0-2856.848,1593.236Z"\n                        fill="#f79900" />\n                </g>\n            </svg>\n            <span data-bind="text: location"></span>\n        </div>\n    </div>\n    <div class="other-content">\n        <div class="title">\n            Ngày đăng\n        </div>\n        <div class="date" data-bind="text: dateCreate">\n        </div>\n        <div class="contact">\n            <div class="img-wrapper">\n                <img data-bind="attr: {src: avatar_user_post}">\n            </div>\n            <div class="contact-wrapper">\n                <div class="user-post" data-bind="text: use_post"></div>\n                <div class="mobile-phone" data-bind="text: phone"></div>\n            </div>\n        </div>\n    </div>\n    <div class="other-content">\n        <div class="title">\n            Chi tiết\n        </div>\n        <div class="description" data-bind="text: description"></div>\n    </div>\n    <div class="other-content">\n        <div class="title">\n            Bình luận\n        </div>\n        <div class="list-comment" id="list-comment">\n            <div class="comment" data-bind="foreach: $root.listComment">\n                <div>\n                    <div class="avatar">\n                        <img data-bind="attr: {src: avatar_uer_comment}">\n                    </div>\n                    <span data-bind="text: user_comment" style="color: #000;"></span>: <span data-bind="text: content"\n                        style="font-style: italic;"></span>\n                </div>\n                <div class="time-comment" data-bind="convertTime: created_at"></div>\n            </div>\n        </div>\n        <div class="xem-them" data-bind="visible: $root.showMore, event: {tap: $root.showMoreAction}">Xem thêm</div>\n        <div class="my-comment">\n            <input type="text" data-bind="textInput: $root.myComment" placeholder="Viết bình luận">\n            <button data-bind="event: {tap: $root.addComment}">Đăng</button>\n        </div>\n    </div>\n    <div class="footer pos-fixed">\n        <div>\n            <svg xmlns="http://www.w3.org/2000/svg" width="15.772" height="15" viewBox="0 0 15.772 15">\n                <path id="Path_1218" data-name="Path 1218"\n                    d="M901.319,1153.873l2.437,4.938,5.449.792-3.943,3.844.931,5.427-4.874-2.562-4.874,2.562.931-5.427-3.943-3.844,5.449-.792Z"\n                    transform="translate(-893.433 -1153.873)" fill="#fff" />\n            </svg>\n            <span>&nbsp;Quan tâm</span>\n\n        </div>\n        <div>\n            <svg xmlns="http://www.w3.org/2000/svg" width="10.842" height="21.085" viewBox="0 0 10.842 21.085">\n                <path id="Path_159" data-name="Path 159"\n                    d="M368.293,250.347a1.276,1.276,0,0,0-1.3-1.308h-8.226a1.281,1.281,0,0,0-1.311,1.3v18.464a1.285,1.285,0,0,0,1.325,1.317q4.094,0,8.192,0a1.508,1.508,0,0,0,.3-.03,1.27,1.27,0,0,0,1.021-1.281q0-4.614,0-9.226T368.293,250.347Zm-6.669-.307H364.2c.176,0,.21.034.212.212,0,.034,0,.067,0,.1,0,.125-.043.167-.172.167-.453,0-.909,0-1.362,0h-1.351c-.15,0-.187-.037-.189-.186C361.334,250.049,361.343,250.039,361.624,250.039Zm1.253,19.495a1.088,1.088,0,0,1-1.083-1.083,1.079,1.079,0,1,1,1.083,1.083Zm4.6-3.205c0,.279-.086.367-.363.367h-8.5c-.253,0-.347-.1-.347-.352V251.72c0-.26.1-.358.354-.358h8.511c.251,0,.345.1.345.354Z"\n                    transform="translate(-357.452 -249.039)" fill="#fff" />\n            </svg>\n\n            <span>&nbsp;&nbsp;Liên hệ</span>\n        </div>\n    </div>\n</div>\n        '}));